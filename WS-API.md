# WebSocket API - Specification
----
## Формат данных
Все взаимодействия между /back и /front, в дальнейшем именуемые events, имеют следующий формат
```json
{
  "id": 1234123412341,
  "time": 12233234,
  "type_id": 1,
  "payload": {...}
}
```
### Аттрибуты
* **id** - Уникальный в пределах системы числовой идентификатор события.
* **time** - Время события unix timestamp
* **[type_id](WS-API.md#%D0%A2%D0%B8%D0%BF%D1%8B-%D0%BF%D0%B5%D1%80%D0%B5%D1%81%D1%8B%D0%BB%D0%B0%D0%B5%D0%BC%D1%8B%D1%85-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)** - Идентификатор типа данных в payload
* **payload** - передаваемый объект

> В случае когда формирование сообщения происходит на клиенте - поле "id" может отсутствовать, в любом случае его значение не учитывается.

## Типы пересылаемых данных

|     type_id    |   Описание  |
|:--------------:|:-----------:|
| `1` | Карточка "Новость" |
| `2` | Карточка "Статья" |
| `3` | Карточка "Рекламный блок" |
| `4` | Карточка "Викторина" |
| `5` | Карточка "Партнерский контент" |
| `6` | Карточка "Место" |
| `7` | Карточка "Мероприятие" |
| `8` | Карточка "Матч" |
| `9` | Карточка "Розыгрыш" |
| `10` | Карточка "Купоны и скидки" |
|      |  |
| `101` | [Текстовое сообщение](WS-API.md#101-%D0%A2%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%B2%D0%BE%D0%B5-%D1%81%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D0%B5) |
| `102` | Картинка |
| `103` | HTML |
| `104` | Координаты |
| `105` | Видео |
| `106` | Стикер |
| `107` | Контакты профиля |
|      |  |

## Формат передаваемых данных (payload)
### `101` Текстовое сообщение
```json
{
"time": 24545455252,
"utid": "de89fy4rbft7gbcctehdn38yxwsdgfs",
"type_id": 101,
"data": {
  "type_id": 101,
  "message": "Здравствуй Петя!",
  "sender_id": 1876876,
  "chat_id": 123,
  "is_forward": false,
  }
}
```
#### Аттрибуты
* **time** - время создания сообщения в Unix Timestamp
* **utid** - уникальный идентификатор сообщения, генерируемый при его создании клиентом.
* **[type_id](WS-API.md#%D0%A2%D0%B8%D0%BF%D1%8B-%D0%BF%D0%B5%D1%80%D0%B5%D1%81%D1%8B%D0%BB%D0%B0%D0%B5%D0%BC%D1%8B%D1%85-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)** - Идентификатор типа данных
* **data** - Полезные данные 
   * **[type_id](WS-API.md#%D0%A2%D0%B8%D0%BF%D1%8B-%D0%BF%D0%B5%D1%80%D0%B5%D1%81%D1%8B%D0%BB%D0%B0%D0%B5%D0%BC%D1%8B%D1%85-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)** - Идентификатор типа данных
   * **message** - Текстовое сообщение
   * **sender_id** - Уникальный идентификатор отправителя
   * **chat_id** - Уникальный идентификатор чата
   * **is_forward** - флаг определяющий что внутри поля **message** находится пересылаемое сообщение
> В случае когда **is_forward** = **true** поле **message** = ```\"{\"time\": 24545455252, \"utid\": "fe89fy4rbft7gbcctehdn38yxwhpl", \"type_id\": 101, \"data\": {\"type_id\": 101,\"message\": \"Здравствуй Петя!\",\"sender_id\": 1876876,\"chat_id\": 123,\"is_forward\": false\"}}```



